# 水下图像修复智能系统 - 设计文档

## 1. 项目概述

### 1.1 项目背景
随着海洋资源勘探、海洋生态监测、水下机器人（ROV/AUV）等技术的发展，水下图像处理已成为海洋科学研究的关键技术。水下成像面临的主要挑战包括：
- **颜色偏移**：红光在水中快速衰减，导致图像呈现蓝绿色调
- **对比度低**：光散射导致图像模糊，细节不清
- **散射噪声**：水中悬浮颗粒造成的前向散射和后向散射
- **深度光衰**：不同深度光照强度差异大，成像质量不一致

### 1.2 项目目标
开发一套集成化的水下图像修复原型系统，实现从图像输入、自动修复、效果对比到质量评估的完整工作流程，提升水下视觉任务的准确性和可靠性。

---

## 2. 系统架构设计

### 2.1 整体架构
采用**模块化分层架构**，包含以下核心层次：

```
┌─────────────────────────────────────────┐
│         用户交互层（UI Layer）            │
│  - 图像上传  - 参数调整  - 结果展示      │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│       业务逻辑层（Service Layer）         │
│  - 图像预处理  - 修复流程控制            │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│       核心算法层（Algorithm Layer）       │
│  - 颜色校正  - 对比度增强  - 去散射      │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│       评估分析层（Evaluation Layer）      │
│  - 定量指标  - 定性分析  - 可视化对比    │
└─────────────────────────────────────────┘
```

### 2.2 技术栈选型（最终确定）

#### 后端技术
- **语言 / 框架**：Python 3.11 + FastAPI + Uvicorn（异步能力满足实时预览与批量处理）。
- **图像计算**：OpenCV、NumPy、SciPy、scikit-image；可选 Torch 2.x / ONNX Runtime 以挂载 WaterNet、UGAN 等模型。
- **任务编排**：Celery + Redis（或 RQ）承接大分辨率处理、批量队列和指标计算，FastAPI 通过 `BackgroundTasks` 触发。
- **存储**：PostgreSQL（SQLModel）保存任务 / 指标，MinIO（S3 兼容）或本地 NVMe 盘分桶保存原图、修复图、报告，支持生命周期管理。
- **实时服务**：FastAPI WebSocket 通道推送手动调参的中间预览；gRPC/ZeroMQ 作为算法容器之间的低延迟通道。
- **DevOps**：Poetry 统一依赖，Docker 多阶段镜像（基础镜像 + 算法镜像）；Prometheus + Grafana 监控性能，Sentry 采集异常。

#### 前端技术
- **框架 / 构建**：React 18 + TypeScript + Vite，React Router DOM 管理 `index/upload/adjustment/comparison/report` 页面。
- **状态与数据**：TanStack Query 负责 API 数据、缓存失效；Zustand 管理即时调参状态并与 WebSocket 同步；Immer 辅助不可变更新。
- **样式与动效**：Tailwind CSS + CSS Variables 复刻 HTML 参考中的渐变与卡片，配合 Framer Motion / AutoAnimate 实现微交互。
- **核心组件库**：Radix UI（Slider/Dialog/Popover）、Headless UI（菜单），`@radix-ui/react-slider` 对应参数调整面板，`react-dropzone` 负责拖拽上传。
- **图像/画布交互**：Canvas API + Konva/Fabric.js 构建双图预览、局部放大、标注；`react-image-comparison-slider` 还原擦除式对比。
- **图表与报告**：Apache ECharts（通过 `echarts-for-react`）绘制指标、柱状图；Recharts 补充简单统计；html2pdf.js 导出报告。
- **质量保证**：ESLint + Prettier + Vitest 做单元测试，Playwright（已安装）跑端到端流程和关键页面可用性回归。

> 以上选型与五个 HTML 参考稿一一匹配：所有页面均以 React 组件化实现，Tailwind 负责设计语言统一，Konva/ECharts/Playwright 分别覆盖交互、可视化与自动化测试需求。

---

## 3. 功能模块详细设计

### 3.1 图像输入模块

#### 3.1.1 功能需求
- 支持多种格式：JPG, PNG, BMP, TIFF
- 支持单张/批量上传
- 图像预览与基本信息展示（分辨率、大小、格式）
- 输入验证（文件大小限制、格式检查）

#### 3.1.2 技术实现要点
- 文件上传采用分片上传机制（支持大文件）
- 前端实时预览（base64编码或URL临时链接）
- 后端临时存储管理（定期清理机制）

#### 3.1.3 用户交互设计
```
┌──────────────────────────────────┐
│   拖拽上传区域                     │
│   或点击选择文件                   │
│   支持格式：JPG/PNG/BMP/TIFF       │
└──────────────────────────────────┘
         ↓ 上传成功
┌──────────────────────────────────┐
│  原始图像预览                      │
│  文件名：underwater_01.jpg         │
│  尺寸：1920x1080  大小：2.3MB      │
│  [开始修复] [批量处理]             │
└──────────────────────────────────┘
```

#### 3.1.4 页面实现（upload.html）
- **页面结构**：React 路由 `/upload` 映射到 `UploadPage` 组件，内部拆分为 `UploadArea`（拖拽框）、`UploadInfoCard`（info-box）、`PreviewGrid`、`ActionBar` 四个子组件，对应 `upload.html` 中的四个视觉区块。
- **拖拽与分片上传**：`react-dropzone` 捕获拖拽事件，使用 `tus-js-client`/`uppy` 将大文件切分为 5~10MB 分片上传到 FastAPI `/api/uploads/chunk`，并通过 `AbortController` 支持取消。
- **本地预览**：利用 `URL.createObjectURL` + `Zustand` 将文件临时地址写入 `previewContainer`，Tailwind + CSS 变量复刻 HTML 原稿的 dashed 边框与渐变背景；移除按钮用 Radix UI `IconButton`。
- **表单校验与提示**：`zod` 描述大小/格式限制，失败时 `react-hot-toast` 弹出；提示条 `InfoBox` 显示和 HTML 一致的文案，并驱动开启“低对比度样本”推荐。
- **批量/文件夹上传**：借助 `showDirectoryPicker`（Chrome）或 `<input webkitdirectory>` 支持整目录导入，后端异步解析。
- **与后端通信**：TanStack Query `useMutation` 上传完成后获取任务 `taskId`，写入 URLSearchParams 并跳转到 `/adjustment?taskId=xxx`。

---

### 3.2 图像修复模块

#### 3.2.1 核心算法组件

##### A. 颜色校正子模块
**问题**：红光衰减导致的颜色偏移

**算法方案**：
1. **白平衡调整**
   - Gray World算法
   - 自适应直方图均衡化（CLAHE）
   
2. **颜色补偿**
   - 基于深度估计的红通道补偿
   - HSV色彩空间调整
   
3. **色调映射**
   - 伽马校正
   - 颜色迁移（参考清晰图像）

**参数设置**：
- 补偿强度：0-100%（默认70%）
- 色温调整：-50 ~ +50（默认+20）
- 饱和度增强：0-200%（默认120%）

##### B. 对比度增强子模块
**问题**：散射导致的低对比度和模糊

**算法方案**：
1. **直方图处理**
   - 自适应直方图均衡化（AHE）
   - 限制对比度自适应直方图均衡（CLAHE）
   
2. **去雾算法改进**
   - 暗通道先验（Dark Channel Prior）
   - 大气散射模型逆向求解
   
3. **锐化增强**
   - Unsharp Masking
   - 拉普拉斯锐化

**参数设置**：
- 对比度强度：1.0-3.0（默认1.8）
- 锐化程度：0-100%（默认60%）
- 去雾强度：0-100%（默认75%）

##### C. 去散射去噪子模块
**问题**：悬浮颗粒造成的散射噪声

**算法方案**：
1. **散射模型**
   - 前向散射补偿
   - 后向散射估计与去除
   
2. **滤波技术**
   - 双边滤波（保边去噪）
   - 非局部均值滤波
   - 引导滤波
   
3. **频域处理**
   - 傅里叶变换去噪
   - 小波变换多尺度去噪

**参数设置**：
- 去噪强度：0-100%（默认50%）
- 保边程度：0-100%（默认70%）

#### 3.2.2 修复流程设计

```
输入图像
    ↓
[预处理]
 - 格式转换
 - 尺寸规范化
 - 颜色空间转换(BGR→RGB)
    ↓
[颜色校正] ← 参数调整
 - 白平衡
 - 红通道补偿
 - HSV调整
    ↓
[对比度增强] ← 参数调整
 - CLAHE
 - 去雾处理
 - 锐化
    ↓
[去散射去噪] ← 参数调整
 - 双边滤波
 - 小波去噪
    ↓
[后处理]
 - 边界处理
 - 颜色空间还原
 - 质量优化
    ↓
输出修复图像
```

#### 3.2.3 智能模式与手动模式

**智能自动模式**：
- 自动检测图像特征（深度、浑浊度、色偏程度）
- 自适应选择最优参数组合
- 一键修复，快速处理

**手动调整模式**：
- 提供所有参数的滑块控制
- 实时预览修复效果
- 支持参数组合保存与加载

#### 3.2.4 手动调整界面实现（adjustment.html）
- **页面结构**：`/adjustment` 页面直接复刻 `adjustment.html` 的左右双列布局——主区域包含 `PreviewPanel`（原图/修复图对照）和 `AdjustPanel`（参数滑块），右侧 `Sidebar` 展示图像信息、快捷操作和建议。
- **双图预览**：使用 `react-konva` 将原图、修复图绘制在两个 Canvas 中，借助 `useMeasure` 自适应 4:3 比例；点击“全屏预览”调用全屏 API。
- **实时调参**：所有 Slider 采用 Radix UI + Tailwind 自定义皮肤，数值保存在 `useAdjustmentStore`（Zustand）。每次滑动通过 `debounce(120ms)` 后推送到 FastAPI WebSocket `/ws/adjust`，后端增量输出 JPEG/PNG Buffer 并用 `createImageBitmap` 快速渲染，确保 `adjustment.html` 所示的即时反馈。
- **预设与持久化**：预设按钮映射为 `PresetGrid` 组件，点击后批量更新 store 并写入 IndexedDB 供下次加载；“保存预设”触发 FastAPI API 以用户维度保存。
- **辅助信息**：Sidebar 的图像信息、处理耗时通过 TanStack Query 轮询 `GET /api/tasks/{id}`，Tailwind 卡片风格与 HTML 设计保持一致。

---

### 3.3 效果对比模块

#### 3.3.1 对比展示方式

##### A. 左右分屏对比
```
┌─────────────────┬─────────────────┐
│   原始图像       │   修复后图像     │
│                 │                 │
│                 │                 │
│                 │                 │
└─────────────────┴─────────────────┘
      [左右切换显示]
```

##### B. 滑动对比（擦除式）
```
┌─────────────────────────────────┐
│  原始 ║ 修复后                    │
│       ║                          │
│       ║← 拖动滑块左右对比         │
│       ║                          │
└─────────────────────────────────┘
```

##### C. 局部放大对比
- 支持同步缩放
- 像素级对比
- 感兴趣区域（ROI）选择

#### 3.3.2 交互功能
- **同步浏览**：双图像同步缩放和移动
- **细节查看**：放大镜工具
- **标注功能**：标记关键改善区域
- **下载功能**：对比图导出

#### 3.3.3 页面实现（comparison.html）
- **组件拆分**：React `/comparison` 页面包含 `ModeSwitcher`、`SplitView`, `SliderView`, `ZoomInspector`, `Toolbar`, `StatsGrid`, `ActionButtons`，和 `comparison.html` 的区块一致。
- **分屏模式**：`SplitView` 使用两个 `<canvas>`（或 `<img>` + object-fit）并共享 `PanZoomController`，可保持同步缩放；标签样式沿用 Tailwind + CSS 变量。
- **滑块模式**：采用 `react-image-comparison-slider`/`react-view-pager` 实现擦除式对比，handle 按照 HTML 设计定制渐变轨迹和箭头，同时监听指针事件更新 `clip-path`。
- **局部放大**：`ZoomInspector` 基于 `react-use-gesture` + Canvas 采样实现放大镜，显示 ROI 坐标，支持“标注工具”在 `Konva.Layer` 上绘制多边形。
- **工具栏与导出**：Toolbar 按钮绑定 `zustand` 中的布尔标志，导出按钮调用 `html-to-image` 生成 PNG；“显示指标”按钮打开 Radix Dialog，内嵌 ECharts 展示 UIQM/UCIQE 等数据。
- **性能优化**：大图使用 `lazy-loading` + `createImageBitmap`，并在切换模式时复用已经加载的纹理，保证与 `comparison.html` 一致的丝滑体验。

---

### 3.4 效果评估模块

#### 3.4.1 定量评估指标

##### A. 无参考指标（Blind Quality Metrics）

1. **UIQM（Underwater Image Quality Measure）**
   - 专门针对水下图像的质量评估
   - 综合考虑色彩丰富度、清晰度和对比度
   - 公式：UIQM = c1×UICM + c2×UISM + c3×UIConM
   - 输出：0-10分，分数越高质量越好

2. **UCIQE（Underwater Color Image Quality Evaluation）**
   - 基于色度、饱和度和对比度
   - 公式：UCIQE = c1×σc + c2×conl + c3×μs
   - 适用于不同水质环境

3. **熵值（Entropy）**
   - 信息丰富度度量
   - 范围：0-8，值越大信息量越大

4. **平均梯度（Average Gradient）**
   - 图像清晰度度量
   - 反映图像细节表现能力

##### B. 全参考指标（需要参考图像时）

1. **PSNR（峰值信噪比）**
   - 范围：20-50dB，越高越好
   - 衡量图像重建质量

2. **SSIM（结构相似性）**
   - 范围：0-1，越接近1越好
   - 从亮度、对比度、结构三方面评估

##### C. 颜色质量指标

1. **颜色偏差**
   - 色彩均衡度
   - RGB通道方差

2. **饱和度提升率**
   - 修复前后饱和度对比

#### 3.4.2 定性评估方法

##### A. 视觉质量评分
- 5级主观评分系统（1-差 ~ 5-优）
- 评价维度：
  - 颜色自然度
  - 清晰度
  - 噪声控制
  - 整体视觉感受

##### B. 任务适配性评估
- 边缘检测效果对比
- 目标识别准确率提升
- 特征点检测数量对比

##### C. 可视化分析
1. **直方图对比**
   - RGB通道直方图
   - 修复前后分布变化

2. **颜色空间分布**
   - HSV/Lab空间可视化
   - 色彩分布均匀性

3. **频域分析**
   - 傅里叶频谱对比
   - 高频细节恢复程度

#### 3.4.3 评估报告生成

**综合报告内容**：
```
╔══════════════════════════════════════╗
║      水下图像修复质量评估报告          ║
╠══════════════════════════════════════╣
║ 1. 基本信息                          ║
║    - 文件名：underwater_coral.jpg     ║
║    - 处理时间：2025-11-12 10:30       ║
║    - 修复耗时：2.3秒                  ║
║                                      ║
║ 2. 定量指标                          ║
║    ┌─────────┬──────┬──────┬──────┐ ║
║    │ 指标    │ 原始 │ 修复 │ 提升 │ ║
║    ├─────────┼──────┼──────┼──────┤ ║
║    │ UIQM    │ 2.1  │ 3.8  │+81%  │ ║
║    │ UCIQE   │ 0.45 │ 0.62 │+38%  │ ║
║    │ 熵值    │ 6.2  │ 7.1  │+15%  │ ║
║    │ 平均梯度│ 4.5  │ 8.3  │+84%  │ ║
║    └─────────┴──────┴──────┴──────┘ ║
║                                      ║
║ 3. 颜色分析                          ║
║    - 色偏校正：偏蓝 → 自然            ║
║    - 饱和度提升：+45%                ║
║    - 对比度提升：+78%                ║
║                                      ║
║ 4. 建议                              ║
║    ✓ 颜色恢复效果显著                ║
║    ✓ 细节清晰度大幅提升              ║
║    ! 部分区域可能存在轻微过增强       ║
╚══════════════════════════════════════╝
```

#### 3.4.4 报告页面实现（report.html）
- **页面布局**：`/report/:taskId` 渲染 `ReportPage`，Flex + `max-w-5xl` 容器与 `report.html` 的卡片排版一致，拆分为 `ReportHeader`、`MetricSection`、`ColorAnalysisSection`、`QualitativeSection` 与 `ActionButtons`。
- **数据绑定**：TanStack Query 根据 `taskId` 调用 `GET /api/reports/{id}` 返回原始/修复指标、主观评分等 JSON；数据用 Zod 校验后再渲染。
- **可视化**：Apache ECharts 绘制折线/条形/仪表图，渐变、圆角配置与 HTML 原稿保持；颜色通道改善对比使用 `echarts-for-react` 自定义 tooltip。
- **表格**：`@tanstack/react-table` 生成表格，可点击行展示详细解释，正负值用条件 class 呈现红/绿文本，复刻 HTML 中的 `positive` 样式。
- **导出能力**：`html2pdf.js` + `dom-to-image` 提供 “导出 PDF / 保存修复图像” 按钮；导出时会请求后台签名的下载链接（避免前端处理大文件）。
- **性能体验**：大段报告采用虚拟滚动（React Virtuoso）避免长文卡顿，并通过 Intersection Observer 触发渐显动画，对齐 `report.html` 中“卡片浮动”效果。

---

## 4. 数据流设计

### 4.1 主流程数据流

```
用户上传 → 前端验证 → 后端接收 → 存储临时文件
                                    ↓
                                读取图像
                                    ↓
                            ┌───────────────┐
                            │  图像预处理    │
                            └───────────────┘
                                    ↓
                            ┌───────────────┐
                            │  修复算法处理  │
                            │  - 颜色校正    │
                            │  - 对比度增强  │
                            │  - 去散射去噪  │
                            └───────────────┘
                                    ↓
                            ┌───────────────┐
                            │  效果评估计算  │
                            └───────────────┘
                                    ↓
                    ┌──────────────┴──────────────┐
                    ↓                             ↓
            保存修复图像                    生成评估报告
                    ↓                             ↓
            返回前端展示 ←───────────────── 返回评估数据
```

### 4.2 数据存储结构

```
project_root/
├── uploads/              # 用户上传的原始图像
│   └── [session_id]/
│       └── original_*.jpg
├── processed/            # 修复后的图像
│   └── [session_id]/
│       └── enhanced_*.jpg
├── cache/                # 中间处理结果缓存
│   └── [session_id]/
│       ├── preprocessed_*.npy
│       └── metrics_*.json
└── reports/              # 评估报告
    └── [session_id]/
        └── report_*.pdf
```

---

## 5. 用户界面设计

### 5.1 主界面布局

```
╔═══════════════════════════════════════════════════════╗
║  水下图像修复系统                          [设置] [帮助] ║
╠═══════════════════════════════════════════════════════╣
║  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ ║
║  │ 上传图像 │  │ 自动修复 │  │ 手动调整 │  │ 批量处理 │ ║
║  └─────────┘  └─────────┘  └─────────┘  └─────────┘ ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  ┌─────────────────────┬─────────────────────┐       ║
║  │   原始图像          │   修复后图像         │       ║
║  │                     │                     │       ║
║  │    [图像显示区]      │    [图像显示区]      │       ║
║  │                     │                     │       ║
║  │                     │                     │       ║
║  └─────────────────────┴─────────────────────┘       ║
║                                                       ║
║  ┌───────────────────────────────────────────┐       ║
║  │          修复参数调整面板                  │       ║
║  │  颜色补偿: [━━━━●━━━━━━] 70%              │       ║
║  │  对比度:   [━━━━━●━━━━━] 80%              │       ║
║  │  去噪强度: [━━━●━━━━━━] 50%              │       ║
║  │  [重置参数] [应用] [保存预设]              │       ║
║  └───────────────────────────────────────────┘       ║
║                                                       ║
║  ┌───────────────────────────────────────────┐       ║
║  │          评估结果显示                      │       ║
║  │  UIQM: 2.1 → 3.8 (+81%) ████████░░         │       ║
║  │  UCIQE: 0.45 → 0.62 (+38%) ████████░░      │       ║
║  │  [详细报告] [导出数据]                     │       ║
║  └───────────────────────────────────────────┘       ║
║                                                       ║
║  [下载原图] [下载修复图] [生成对比报告]               ║
╚═══════════════════════════════════════════════════════╝
```

### 5.2 交互流程

1. **上传阶段**
   - 拖拽或点击上传
   - 显示上传进度
   - 预览原始图像

2. **修复阶段**
   - 选择自动/手动模式
   - 实时预览（手动模式）
   - 显示处理进度

3. **对比阶段**
   - 默认左右对比
   - 切换对比模式
   - 局部放大查看

4. **评估阶段**
   - 自动计算指标
   - 可视化展示
   - 生成报告

### 5.3 页面组件化实现（index.html）
- **组件树**：主页 `/` 映射 `DashboardPage`，由 `Header`（设置/帮助/退出按钮）、`WelcomeBanner`、`QuickActions`、`StatsGrid`、`RecentSection` 五大组件组成，对应 `index.html` 的视觉结构。
- **交互与数据**：`QuickActions` 的 4 张卡片触发 `react-router` 跳转到 `/upload`、`/auto`、`/adjustment`、`/batch`；`StatsGrid` 通过 TanStack Query 读取 `GET /api/summary`，增加骨架屏；“最近处理”列表支持无限滚动与筛选，图标与状态胶囊沿用 Tailwind + CSS 变量。
- **样式复刻**：Tailwind 自定义主题定义 `gradient-primary` `card-shadow` 等 tokens，保证与 `index.html` 一致的渐变头部、卡片阴影与 icon 字体；`Framer Motion` 提供卡片 hover 上浮动画。
- **可扩展性**：Dashboard 预留 Context 用于全局通知与多语言，本地化通过 `i18next`；Header 的“帮助”按钮拉起 Radix Dialog 内嵌操作指引。
- **可访问性**：所有按钮带 `aria-label`，卡片内容采用语义化 `<section>` + `<h2>`，确保 Playwright + axe-core 自动化检查通过。

---

## 6. 系统性能优化

### 6.1 处理速度优化

1. **算法优化**
   - 使用NumPy向量化操作
   - GPU加速（CUDA/OpenCL）
   - 多线程并行处理

2. **缓存机制**
   - 中间结果缓存
   - 参数预设缓存
   - 图像缩略图缓存

3. **分辨率自适应**
   - 预览使用低分辨率
   - 最终输出高分辨率
   - 支持自定义分辨率

### 6.2 内存管理

1. **图像分块处理**
   - 大图像分块加载
   - 流式处理
   - 及时释放内存

2. **临时文件清理**
   - 定时清理机制
   - 会话过期处理
   - 磁盘空间监控

---

## 7. 扩展功能规划

### 7.1 短期扩展（Version 1.1）

1. **批量处理**
   - 支持文件夹批量导入
   - 统一参数应用
   - 批量导出

2. **预设模板**
   - 浅水场景预设
   - 深水场景预设
   - 浑浊水体预设
   - 自定义预设保存

3. **历史记录**
   - 处理历史查看
   - 参数配置记录
   - 结果对比

### 7.2 中期扩展（Version 2.0）

1. **深度学习增强**
   - 集成预训练模型（如WaterNet、UGAN）
   - 端到端修复网络
   - 模型在线更新

2. **视频处理**
   - 逐帧修复
   - 时序一致性优化
   - 实时预览

3. **3D场景重建辅助**
   - 立体视觉支持
   - 深度图估计
   - SLAM辅助

### 7.3 长期扩展（Version 3.0）

1. **云端服务**
   - 在线API接口
   - 移动端APP
   - 多用户协作

2. **智能分析**
   - 场景自动识别
   - 最优算法推荐
   - 质量自动评级

3. **数据集管理**
   - 修复前后数据集构建
   - 用于模型训练
   - 效果benchmark

---

## 8. 测试策略

### 8.1 功能测试

1. **单元测试**
   - 各算法模块独立测试
   - 边界条件测试
   - 异常处理测试

2. **集成测试**
   - 完整流程测试
   - 模块间接口测试
   - 数据流验证

3. **用户验收测试**
   - 真实场景图像测试
   - 不同水质环境测试
   - 极端情况测试

### 8.2 性能测试

1. **速度测试**
   - 不同分辨率处理时间
   - 批量处理效率
   - 并发处理能力

2. **质量测试**
   - 评估指标准确性
   - 视觉质量主观评价
   - 与现有方法对比

### 8.3 测试数据集

推荐使用公开数据集：
- **UIEB**（Underwater Image Enhancement Benchmark）
- **EUVP**（Enhancing Underwater Visual Perception）
- **U45**（45张水下图像）
- 自采集多场景数据

---

## 9. 部署方案

### 9.1 本地部署

**适用场景**：个人使用、实验室研究

**部署方式**：
- 桌面应用（Electron打包）
- 或Web应用（本地服务器）

**系统要求**：
- CPU: Intel i5 或更高
- 内存: 8GB+
- 显卡: NVIDIA GPU（可选，用于加速）
- 存储: 2GB可用空间

### 9.2 服务器部署

**适用场景**：多用户访问、云端服务

**部署架构**：
```
负载均衡器
    ↓
Web服务器集群
    ↓
应用服务器（Flask/FastAPI）
    ↓
处理队列（Redis/Celery）
    ↓
存储服务（NFS/对象存储）
```

**容器化部署**：
- Docker容器化
- Kubernetes编排
- CI/CD自动部署

---

## 10. 项目管理

### 10.1 开发阶段划分

**阶段一（2周）**：核心算法实现
- 颜色校正算法
- 对比度增强算法
- 去散射去噪算法

**阶段二（2周）**：评估模块开发
- 定量指标计算
- 定性分析工具
- 可视化展示

**阶段三（2周）**：界面开发与集成
- 前端界面设计
- 后端API开发
- 前后端联调

**阶段四（1周）**：测试与优化
- 功能测试
- 性能优化
- Bug修复

### 10.2 技术难点预判

1. **颜色校正准确性**
   - 不同水质环境差异大
   - 需要自适应算法

2. **实时性要求**
   - 高分辨率图像处理耗时
   - 需要优化算法效率

3. **评估标准**
   - 无真值参考的质量评估
   - 需要可靠的无参考指标

---

## 11. 文档与支持

### 11.1 用户文档

- 快速入门指南
- 功能使用说明
- 常见问题FAQ
- 参数调整建议

### 11.2 开发文档

- API接口文档
- 算法原理说明
- 代码架构文档
- 扩展开发指南

---

## 12. 总结

本设计文档在最低要求基础上进行了全面完善，构建了一套完整的水下图像修复系统方案。系统采用模块化设计，具备良好的可扩展性，既满足当前原型系统需求，也为未来功能扩展预留了空间。

**核心优势**：
- ✅ 完整的工作流程（输入→修复→对比→评估）
- ✅ 多种算法组合（颜色+对比度+去噪）
- ✅ 全面的评估体系（定量+定性）
- ✅ 友好的用户界面（自动+手动模式）
- ✅ 良好的扩展性（支持深度学习、视频等）

接下来可以根据此设计文档进行详细的代码实现。您对这个设计方案有什么意见或需要调整的地方吗?
